# 実装ロードマップ

## 概要

本ロードマップは、Soundmanシステムを段階的に開発するための計画です。各フェーズは明確な成果物を持ち、実用的な価値を提供しながら、次のフェーズへの基盤となります。

---

## Phase 0: プロジェクトセットアップ ✅ **完了**

### 目標
開発環境を整え、プロジェクトの骨組みを構築する

### デスクトップアプリ

#### タスク
- [x] プロジェクト初期化
  - [x] CMakeプロジェクト作成
  - [x] JUCE フレームワークの統合
  - [x] ディレクトリ構造の作成
  - [x] .gitignore設定

- [x] 基本的なアプリケーション構造
  - [x] Main.cpp（エントリーポイント）
  - [x] MainComponent（メインウィンドウ）
  - [x] 空のUI表示確認

- [x] ビルドシステム
  - [x] Debug/Releaseビルド設定
  - [x] クロスプラットフォームビルド確認（Windows/Mac/Linux）

### Webアプリ

#### タスク
- [x] プロジェクト初期化
  - [x] Viteプロジェクト作成
  - [x] Vue 3 + TypeScript設定
  - [x] ディレクトリ構造の作成
  - [x] ESLint/Prettier設定

- [x] 基本的なアプリケーション構造
  - [x] Vue Router設定
  - [x] Pinia（状態管理）設定
  - [x] 基本レイアウトコンポーネント

- [x] 開発環境
  - [x] 開発サーバー起動確認
  - [x] Hot reload動作確認

### 共通

- [x] データディレクトリ設計
  - [x] `data/` フォルダ構造作成
  - [x] サンプルlibrary.json作成
  - [x] JSONスキーマ定義

- [x] ドキュメント
  - [x] README.md作成
  - [x] 開発環境セットアップガイド

### 成果物
- ✅ ビルド可能なデスクトップアプリの雛形
- ✅ 起動可能なWebアプリの雛形
- ✅ 基本的なデータ構造

---

## Phase 1: MVP - 基本機能実装 ✅ **完了**

### 目標
最小限の実用的な機能を持つ両アプリを完成させる

### デスクトップアプリ

#### 1. オーディオ入力・再生

- [x] AudioEngine実装
  - [x] JUCE AudioDeviceManager統合
  - [x] オーディオデバイス選択UI
  - [x] サンプルレート/バッファサイズ設定

- [x] ファイル再生機能
  - [x] WAV/AIFF/MP3/FLAC対応
  - [x] 再生制御（Play/Pause/Stop）
  - [x] ファイル選択ダイアログ

- [x] 基本的なオーディオパイプライン構築

#### 2. 波形表示

- [x] WaveformDisplay コンポーネント
  - [x] リアルタイム波形描画
  - [x] 60fps更新
  - [x] ステレオ対応（L/R分離表示）

- [x] 表示制御
  - [x] ズーム機能
  - [x] 垂直スケール調整

#### 3. FFTスペクトラム解析

- [x] FFTAnalyzer実装
  - [x] JUCE FFTクラス使用
  - [x] 窓関数実装（Hamming/Hann/Blackman）
  - [x] オーバーラップ処理

- [x] SpectrumDisplay コンポーネント
  - [x] 周波数スペクトラム表示
  - [x] バー/ライン表示モード
  - [x] dBスケール表示

- [x] 設定UI
  - [x] FFTサイズ選択（512-8192）
  - [x] 窓関数選択
  - [x] 表示モード切替

#### 4. レベルメーター

- [x] LevelMeter実装
  - [x] ピークレベル計算
  - [x] RMSレベル計算
  - [x] ピークホールド機能

- [x] LevelMeterComponent
  - [x] ステレオメーター表示
  - [x] クリッピング警告
  - [x] カラースケール（緑→黄→赤）

#### 5. データエクスポート

- [x] JSON出力
  - [x] 解析結果のエクスポート
  - [x] DataExporter実装
  - [x] ファイル情報・レベル測定・高度な測定値のエクスポート

- [x] スクリーンショット機能

#### 6. 高度な測定機能（追加実装）

- [x] True Peak Meter
  - [x] オーバーサンプリングによる真のピーク検出
  - [x] dBTP表示
  - [x] ステレオ対応

- [x] Phase Correlation Meter
  - [x] ステレオ位相相関測定
  - [x] -1 ～ +1 スケール表示
  - [x] モノラル互換性チェック

- [x] Loudness Meter (EBU R128)
  - [x] Integrated Loudness (LUFS)
  - [x] Short-term Loudness
  - [x] Momentary Loudness
  - [x] Loudness Range (LRA)

#### 7. UI/UXコンポーネント（追加実装）

- [x] Multi-View Container
  - [x] グリッドレイアウト（1x1, 2x1, 2x2）
  - [x] 複数の表示モード切替
  - [x] ビューごとの独立した設定

- [x] Tabbed Display Area
  - [x] タブベースのUI
  - [x] 複数のビジュアライゼーション切替

- [x] Vectorscope Display
  - [x] ステレオイメージング表示
  - [x] リサージュパターン

- [x] Histogram Display
  - [x] レベル分布表示
  - [x] ダイナミックレンジ可視化

- [x] Timecode Display
  - [x] 時:分:秒.ミリ秒表示
  - [x] サンプル位置表示

- [x] Master Gain Control
  - [x] マスターボリューム調整
  - [x] dBスケール表示
  - [x] リアルタイムゲイン適用

#### 8. 設定・情報パネル（追加実装）

- [x] Settings Dialog
  - [x] オーディオデバイス設定
  - [x] サンプルレート/バッファサイズ設定
  - [x] JUCE AudioDeviceSelector統合

- [x] File Info Panel
  - [x] ファイル情報表示
  - [x] フォーマット・サンプルレート・チャンネル数
  - [x] ビット深度・長さ表示

- [x] Recording Panel
  - [x] 録音UI
  - [x] 録音制御（Record/Pause/Stop）
  - [x] バックエンド実装（WAV録音機能）
  - [x] ThreadedWriter使用

- [x] Playlist Panel
  - [x] プレイリストUI
  - [x] ファイルリスト表示
  - [x] バックエンド基盤実装

#### 9. キーボードショートカット

- [x] KeyboardHandler実装
  - [x] 再生制御（Space, Enter, Esc）
  - [x] ファイル操作（Ctrl+O, Ctrl+S, Ctrl+E）
  - [x] 録音制御（Ctrl+R, Ctrl+Shift+R）
  - [x] 設定・情報表示（Ctrl+,, Ctrl+I）

### Webアプリ

#### 1. ファイル一覧（1週間）

- [ ] Library Store実装
  - [ ] library.json読み込み
  - [ ] ファイルリスト管理

- [ ] FileList/FileGrid コンポーネント
  - [ ] グリッド表示
  - [ ] リスト表示
  - [ ] 表示切替

- [ ] ファイルカード
  - [ ] 基本情報表示（名前、サイズ、長さ）
  - [ ] サムネイル表示

#### 2. メタデータ表示・編集（1-2週間）

- [ ] MetadataEditor コンポーネント
  - [ ] 全フィールド表示
  - [ ] インライン編集
  - [ ] 保存機能

- [ ] タグ管理
  - [ ] TagInput コンポーネント
  - [ ] オートコンプリート
  - [ ] タグ追加・削除

- [ ] バッチ編集
  - [ ] 複数ファイル選択
  - [ ] 一括メタデータ更新

#### 3. 検索・フィルタ（1週間）

- [ ] 検索機能
  - [ ] テキスト検索
  - [ ] リアルタイムフィルタリング

- [ ] FilterPanel コンポーネント
  - [ ] タグフィルタ
  - [ ] ファイルタイプフィルタ
  - [ ] BPM範囲フィルタ

- [ ] ソート機能
  - [ ] 名前、日付、サイズ、BPM等

#### 4. プレビュー再生（1週間）

- [ ] AudioPlayer実装
  - [ ] Howler.js統合
  - [ ] 再生制御

- [ ] AudioPlayer コンポーネント
  - [ ] プレーヤーUI
  - [ ] 波形表示（WaveSurfer.js）
  - [ ] 再生位置シーク

#### 5. ファイルインポート（数日）

- [ ] ドラッグ&ドロップ
  - [ ] ファイルドロップゾーン
  - [ ] 複数ファイル対応

- [ ] メタデータ自動抽出
  - [ ] 基本情報読み取り
  - [ ] library.jsonに追加

### 統合タスク

- [ ] データ共有テスト
  - [ ] デスクトップアプリからデータ書き込み
  - [ ] Webアプリでデータ読み込み確認
  - [ ] 双方向のデータ同期確認

- [ ] ファイルロック機構
  - [ ] 簡易ロックファイル実装

### 成果物
- ✅ **デスクトップアプリ**: プロフェッショナル音響解析ツール
  - ✅ オーディオ入力・ファイル再生（WAV/AIFF/MP3/FLAC対応）
  - ✅ リアルタイム波形表示（ステレオ対応、ズーム機能）
  - ✅ FFTスペクトラム解析（複数窓関数、dBスケール）
  - ✅ 標準レベルメーター（RMS/Peak、クリッピング警告）
  - ✅ True Peakメーター（dBTP表示）
  - ✅ Phase Correlationメーター（ステレオ位相）
  - ✅ Loudnessメーター（EBU R128準拠、LUFS/LRA）
  - ✅ Vectorscope（ステレオイメージング）
  - ✅ Histogram（レベル分布）
  - ✅ マルチビューレイアウト（グリッド表示）
  - ✅ 録音機能（WAV形式、16-bit PCM）
  - ✅ データエクスポート（JSON形式）
  - ✅ 設定ダイアログ（デバイス選択）
  - ✅ キーボードショートカット
  - ✅ マスターゲインコントロール

- **Webアプリ**: データ管理ツール（実装予定）
  - ファイル一覧・検索
  - メタデータ編集
  - プレビュー再生

---

## Phase 2: 機能拡張（4-6週間） ✅ **デスクトップアプリ完了**

### 目標
分析機能とデータ管理機能を強化

### デスクトップアプリ ✅ **完了**

#### 解析機能の強化

- [x] スペクトログラム表示 ✅
  - [x] 時間-周波数表示（ウォーターフォール）
  - [x] カラーマップ（ヒートマップ）
  - [x] リアルタイム更新

- [x] 追加の音響解析 ✅
  - [x] ピッチ検出（YINアルゴリズム）
    - [x] リアルタイム周波数検出
    - [x] 音名・MIDIノート表示
    - [x] セント偏差メーター
    - [x] 信頼度表示
    - [x] ピッチ履歴グラフ
    - [x] 感度パラメータUI（閾値、周波数範囲）
  - [x] ハーモニクス解析
    - [x] 基音・倍音検出
    - [x] ハーモニクス構造表示
  - [x] MFCC計算
    - [x] メル周波数ケプストラム係数
    - [x] 係数表示

- [x] 録音機能 ✅ **Phase 1で完了**
  - [x] マイク入力録音
  - [x] WAVファイル保存
  - [x] 録音レベル調整
  - [x] Pause/Resume機能

#### エフェクト処理 ✅

- [x] 基本フィルター ✅
  - [x] ローパス/ハイパス/バンドパス/ノッチ
  - [x] ローシェルフ/ハイシェルフ/ピーク
  - [x] 周波数・Q・ゲイン調整UI
  - [x] 周波数応答カーブ表示

- [x] EQ ✅
  - [x] 3バンドパラメトリックEQ
  - [x] リアルタイムプレビュー
  - [x] バンドごとの有効/無効切替
  - [x] オーディオ処理パイプライン統合

### Webアプリ

#### データ管理の強化

- [ ] プロジェクト機能
  - [ ] プロジェクト作成・編集
  - [ ] ファイルをプロジェクトに追加
  - [ ] プロジェクト一覧表示

- [ ] 高度な検索
  - [ ] 音響特性による検索
  - [ ] 保存済み検索
  - [ ] スマートコレクション

- [ ] 統計・レポート
  - [ ] ライブラリ統計表示
  - [ ] タグ分布グラフ
  - [ ] 使用頻度分析

#### UI/UX改善

- [ ] ダッシュボード
  - [ ] 最近使用したファイル
  - [ ] 統計サマリー
  - [ ] クイックアクション

- [ ] キーボードショートカット
  - [ ] ファイル操作
  - [ ] 再生制御

- [ ] テーマ機能
  - [ ] ダーク/ライトモード
  - [ ] カスタムカラー

### 成果物
- 強化された解析機能
- プロジェクト管理機能
- 改善されたUI/UX

---

## Phase 3: 高度な機能（6-8週間） 🔄 **進行中**

### 目標
プロフェッショナル向け機能を追加

### デスクトップアプリ

#### 測定・計測機能

- [x] THD（全高調波歪み率）測定 ✅
- [x] THD+N（THD+ノイズ）測定 ✅
- [x] S/N比（SNR）測定 ✅
- [x] SINAD測定 ✅
- [x] インパルス応答測定 ✅
- [x] 周波数応答測定 ✅

#### 信号生成 ✅

- [x] トーンジェネレーター ✅
  - [x] サイン波、矩形波、三角波、ノコギリ波
  - [x] 周波数（20Hz-20kHz）・振幅（-60〜0dB）調整

- [x] ノイズジェネレーター ✅
  - [x] ホワイト/ピンク/ブラウンノイズ
  - [x] 振幅調整

- [x] スイープジェネレーター ✅
  - [x] リニア/対数スイープ
  - [x] 開始・終了周波数、時間設定

#### プラグインシステム

- [ ] VST3ホスト機能
- [ ] プラグインスキャン
- [ ] エフェクトチェーン

#### プロフェッショナルUI ✅

- [x] TopInfoBar（Logic Pro / Pro Tools風）✅
  - [x] ファイル情報表示
  - [x] トランスポートコントロール（Play/Pause/Stop/Record/Loop）
  - [x] LCDタイムコード表示
  - [x] Duration/BPM表示
  - [x] ミニレベルメーター
  - [x] デバイス情報表示
  - [x] Open/Settingsボタン

- [x] BPM検出 ✅
  - [x] リアルタイムテンポ解析
  - [x] BPM表示

- [x] キー検出 ✅
  - [x] 音階解析
  - [x] キー表示

- [x] デュアルトラック比較 ✅
  - [x] Track A / Track B読み込み
  - [x] A/B切り替え / ミックス
  - [x] 比較波形表示

- [x] マーカーパネル ✅
  - [x] マーカー追加/削除
  - [x] マーカージャンプ
  - [x] タイムラインとの同期

- [x] オーディオタイムライン ✅
  - [x] 波形表示
  - [x] ループ範囲設定
  - [x] マーカー表示
  - [x] 選択範囲

- [x] パフォーマンス最適化 ✅
  - [x] Vectorscope最適化（バッファ削減、パスキャッシュ）
  - [x] Histogram最適化（ビン数削減、カラー事前計算）

#### マルチトラックDAW機能 🔄 **進行中**

##### T1: プロジェクトデータモデル ✅
- [x] T1-1: ValueTreeスキーマ定義（Project/Track/Clip）
  - [x] ProjectModel.h - IDs名前空間（PROJECT, TRACK, CLIP, MASTER）
  - [x] ClipModel - クリップ情報（audioFilePath, sourceStart, length, timelineStart, gain, fadeIn/Out）
  - [x] TrackModel - トラック情報（name, volume, pan, mute, solo, armed, order, color）
  - [x] ProjectModel - プロジェクト情報（projectName, sampleRate, bpm, timeSignature）
- [x] T1-2: UndoManager統合
  - [x] ProjectManager - 全操作にUndoManager連携
  - [x] beginTransaction/undo/redo対応
- [x] T1-3: プロジェクト保存/読み込み
  - [x] XML形式でのシリアライズ
  - [x] .smproj拡張子
  - [x] バージョン管理

##### T2: マルチトラック再生エンジン
- [ ] T2-1: MultiTrackAudioSource基礎
  - [ ] 複数トラック合成
  - [ ] トラックボリューム/パン適用
- [ ] T2-2: クリップミキシング
  - [ ] 複数クリップの同時再生
  - [ ] フェードイン/アウト処理
  - [ ] クリップゲイン適用
- [ ] T2-3: タイムライン位置同期
  - [ ] 再生ヘッド位置管理
  - [ ] シーク機能
- [ ] T2-4: ミュート/ソロ処理
  - [ ] トラックミュート
  - [ ] ソロ排他制御

##### T3: タイムラインUI + クリップ編集
- [ ] T3-1: TimelinePanel（トラックヘッダ + クリップ領域）
  - [ ] トラックヘッダ表示（名前、Mute/Solo/Arm）
  - [ ] クリップ領域描画
- [ ] T3-2: クリップ波形表示
  - [ ] AudioThumbnailCache統合
  - [ ] サムネイル描画
- [ ] T3-3: ドラッグ移動
  - [ ] クリップ選択
  - [ ] ドラッグ＆ドロップ移動
- [ ] T3-4: トリミングハンドル
  - [ ] 開始点/終了点調整
  - [ ] sourceStart連動
- [ ] T3-5: クリップ分割
  - [ ] 分割ポイント指定
  - [ ] 新規クリップ生成
- [ ] T3-6: スナップ＆グリッド
  - [ ] ビート/バー単位スナップ
  - [ ] グリッド表示

##### T4: ミキサーUI + トラックFX
- [ ] T4-1: MixerPanel（縦フェーダー + パン + Mute/Solo）
  - [ ] チャンネルストリップ
  - [ ] フェーダー操作
- [ ] T4-2: インサートエフェクト
  - [ ] EffectChain統合
  - [ ] エフェクト順序管理
- [ ] T4-3: トラックメーター
  - [ ] トラック別レベル表示
  - [ ] マスターメーター
- [ ] T4-4: オートメーション基礎
  - [ ] パラメータ記録
  - [ ] 再生時適用

##### T5: エクスポート & 解析統合
- [ ] T5-1: マルチトラックレンダリング
  - [ ] オフラインバウンス
  - [ ] WAV/FLAC出力
- [ ] T5-2: トラック別解析
  - [ ] 既存AnalysisPanel連携
  - [ ] トラック選択切り替え

### Webアプリ

#### 自動解析・分類

- [ ] BPM自動検出
  - [ ] テンポ解析アルゴリズム
  - [ ] 結果の精度表示

- [ ] キー検出
  - [ ] 音階解析
  - [ ] Camelot Wheel表示

- [ ] 音響フィンガープリント
  - [ ] 類似音検索
  - [ ] 重複検出

#### バージョン管理

- [ ] 編集履歴
  - [ ] 変更トラッキング
  - [ ] 差分表示
  - [ ] ロールバック

- [ ] バックアップ機能
  - [ ] 自動バックアップ
  - [ ] リストア機能

#### 連携機能

- [ ] DAW連携
  - [ ] Ableton Link対応
  - [ ] ファイルエクスポート

- [ ] クラウド同期
  - [ ] メタデータ同期
  - [ ] 設定同期

### 成果物
- プロフェッショナル測定ツール
- 自動解析機能
- DAW連携機能

---

## Phase 4: 最適化・品質向上（4週間）

### 目標
パフォーマンス、安定性、ユーザビリティを向上

### 全体

#### パフォーマンス最適化

- [ ] デスクトップアプリ
  - [ ] オーディオ処理の最適化
  - [ ] レンダリングの最適化
  - [ ] メモリ使用量削減

- [ ] Webアプリ
  - [ ] 仮想スクロール実装
  - [ ] 遅延読み込み最適化
  - [ ] キャッシュ戦略改善

#### 品質改善

- [ ] テストカバレッジ向上
  - [ ] ユニットテスト追加
  - [ ] 統合テスト
  - [ ] E2Eテスト

- [ ] エラーハンドリング
  - [ ] エラー処理の統一
  - [ ] ユーザーフレンドリーなエラーメッセージ

- [ ] ログ機能
  - [ ] 詳細ログ出力
  - [ ] デバッグモード

#### ドキュメント

- [ ] ユーザーマニュアル
- [ ] API ドキュメント
- [ ] トラブルシューティングガイド

#### 多言語対応

- [ ] i18n実装
- [ ] 日本語・英語対応

### 成果物
- 最適化されたパフォーマンス
- 高品質なコードベース
- 充実したドキュメント

---

## Phase 5: リリース準備（2-3週間）

### 目標
一般公開に向けた準備

### タスク

- [ ] インストーラー作成
  - [ ] Windows（NSIS）
  - [ ] macOS（DMG）
  - [ ] Linux（AppImage）

- [ ] CI/CD構築
  - [ ] 自動ビルド
  - [ ] 自動テスト
  - [ ] 自動デプロイ

- [ ] ベータテスト
  - [ ] ベータ版リリース
  - [ ] フィードバック収集
  - [ ] バグフィックス

- [ ] マーケティング資料
  - [ ] Webサイト
  - [ ] スクリーンショット
  - [ ] デモ動画

### 成果物
- リリース可能な製品
- インストーラー
- マーケティング資料

---

## 長期的な展望（Phase 6+）

### 機能追加案

- **AI/機械学習**
  - ジャンル自動分類
  - 音源分離
  - マスタリング支援

- **コラボレーション**
  - マルチユーザー対応
  - クラウドストレージ統合
  - リアルタイム共同編集

- **モバイル対応**
  - iOS/Androidアプリ
  - リモートコントロール

- **拡張性**
  - プラグインマーケットプレイス
  - カスタムテーマストア
  - コミュニティ機能

---

## マイルストーン

| フェーズ | 期間 | 主要成果物 | リリース | ステータス |
|---------|------|-----------|---------|----------|
| Phase 0 | 1-2週間 | プロジェクトセットアップ | - | ✅ 完了 |
| Phase 1 | 4-6週間 | MVP（デスクトップアプリの基本機能） | Alpha 0.2 | ✅ 完了 |
| Phase 2 | 4-6週間 | 機能拡張 | Alpha 0.5 | ✅ デスクトップ完了 |
| Phase 3 | 6-8週間 | 高度な機能 | Alpha 0.6 | 🔄 デスクトップ進行中 |
| Phase 4 | 4週間 | 最適化・品質向上 | Beta 0.9 | 予定 |
| Phase 5 | 2-3週間 | リリース準備 | v1.0 | 予定 |

**注**: Phase 1-3では当初予定よりも多くの機能を実装しました。デスクトップアプリは以下の高度な機能を含む本格的な音響解析ツールになっています：
- 基本測定: True Peak、Phase Correlation、Loudness (EBU R128)
- 可視化: Multi-View、Vectorscope、Histogram、スペクトログラム
- 解析: ピッチ検出 (YIN)、ハーモニクス解析、MFCC、BPM検出、キー検出
- エフェクト: フィルター (LP/HP/BP/Notch/Shelf/Peak)、3バンドパラメトリックEQ
- 録音: WAV形式、Pause/Resume対応
- 測定: THD、THD+N、SNR、SINAD、インパルス応答、周波数応答
- 信号生成: トーン、ノイズ、スイープジェネレーター
- プロフェッショナルUI: TopInfoBar（Logic Pro/Pro Tools風）、デュアルトラック比較、マーカー、タイムライン
- マルチトラックDAW: プロジェクトデータモデル（ValueTree）、UndoManager統合、プロジェクト保存/読み込み

---

## リスク管理

### 主要リスク

1. **技術的な困難**
   - JUCE学習曲線
   - リアルタイム処理の複雑さ
   - 対応：プロトタイプで早期検証

2. **スコープクリープ**
   - 機能追加の誘惑
   - 対応：MVPに集中、Phase分割厳守

3. **パフォーマンス問題**
   - 大量ファイル処理
   - 対応：早期最適化、定期的なプロファイリング

4. **クロスプラットフォーム対応**
   - プラットフォーム固有の問題
   - 対応：各プラットフォームで定期的にテスト

---

## 次のステップ

1. **Phase 0を開始**
   - デスクトップアプリのプロジェクト作成
   - Webアプリのプロジェクト作成
   - データディレクトリ準備

2. **開発環境のセットアップ**
   - 必要なツールのインストール
   - ビルド環境の確認

3. **最初のタスクを選ぶ**
   - どちらのアプリから始めるか決定
   - 最初の機能実装に着手

準備が整い次第、Phase 0のタスクから始めましょう！
